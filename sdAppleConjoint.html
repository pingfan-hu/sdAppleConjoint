<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>sdappleconjoint</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="sdAppleConjoint_files/libs/clipboard/clipboard.min.js"></script>
<script src="sdAppleConjoint_files/libs/quarto-html/quarto.js"></script>
<script src="sdAppleConjoint_files/libs/quarto-html/popper.min.js"></script>
<script src="sdAppleConjoint_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="sdAppleConjoint_files/libs/quarto-html/anchor.min.js"></script>
<link href="sdAppleConjoint_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="sdAppleConjoint_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="sdAppleConjoint_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="sdAppleConjoint_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="sdAppleConjoint_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="sdAppleConjoint_files/libs/quarto-contrib/hidepagesjs/hide_pages.js"></script>
<script src="sdAppleConjoint_files/libs/quarto-contrib/updateprogressjs/update_progress.js"></script>
<link href="sdAppleConjoint_files/libs/quarto-contrib/surveydowncss/surveydown.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




  <style>
  #progressbar.top {
    top: 0;
  }
  body {
    background-color: #f2f6f9;
  }
  </style>
  
  <div id="progressbar" class="top">
    <div id="progress" style="background-color: #2780E3;"></div>
  </div>
  
  <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,400;0,800;1,400;1,800&amp;display=swap" rel="stylesheet">
  <style>
  body, .h1, .h2, .h3, .h4, .h5, .h6, h1, h2, h3, h4, h5, h6 {
    font-family: 'Raleway', sans-serif;
  }
  </style>
  
<div class="cell" data-context="setup">
<div class="cell-output-display">
<!--SHINY.SINGLETON[223eed69850a44625b94f39193177e317dbc7f92]-->
<script>Shiny.addCustomMessageHandler('shinyjs-show', function(params) { shinyjs.debugMessage('shinyjs: calling function "show" with parameters:'); shinyjs.debugMessage(params); shinyjs.show(params);});
Shiny.addCustomMessageHandler('shinyjs-hide', function(params) { shinyjs.debugMessage('shinyjs: calling function "hide" with parameters:'); shinyjs.debugMessage(params); shinyjs.hide(params);});
Shiny.addCustomMessageHandler('shinyjs-toggle', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggle" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggle(params);});
Shiny.addCustomMessageHandler('shinyjs-enable', function(params) { shinyjs.debugMessage('shinyjs: calling function "enable" with parameters:'); shinyjs.debugMessage(params); shinyjs.enable(params);});
Shiny.addCustomMessageHandler('shinyjs-disable', function(params) { shinyjs.debugMessage('shinyjs: calling function "disable" with parameters:'); shinyjs.debugMessage(params); shinyjs.disable(params);});
Shiny.addCustomMessageHandler('shinyjs-toggleState', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggleState" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggleState(params);});
Shiny.addCustomMessageHandler('shinyjs-addClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "addClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.addClass(params);});
Shiny.addCustomMessageHandler('shinyjs-removeClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "removeClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.removeClass(params);});
Shiny.addCustomMessageHandler('shinyjs-toggleClass', function(params) { shinyjs.debugMessage('shinyjs: calling function "toggleClass" with parameters:'); shinyjs.debugMessage(params); shinyjs.toggleClass(params);});
Shiny.addCustomMessageHandler('shinyjs-html', function(params) { shinyjs.debugMessage('shinyjs: calling function "html" with parameters:'); shinyjs.debugMessage(params); shinyjs.html(params);});
Shiny.addCustomMessageHandler('shinyjs-onevent', function(params) { shinyjs.debugMessage('shinyjs: calling function "onevent" with parameters:'); shinyjs.debugMessage(params); shinyjs.onevent(params);});
Shiny.addCustomMessageHandler('shinyjs-removeEvent', function(params) { shinyjs.debugMessage('shinyjs: calling function "removeEvent" with parameters:'); shinyjs.debugMessage(params); shinyjs.removeEvent(params);});
Shiny.addCustomMessageHandler('shinyjs-alert', function(params) { shinyjs.debugMessage('shinyjs: calling function "alert" with parameters:'); shinyjs.debugMessage(params); shinyjs.alert(params);});
Shiny.addCustomMessageHandler('shinyjs-logjs', function(params) { shinyjs.debugMessage('shinyjs: calling function "logjs" with parameters:'); shinyjs.debugMessage(params); shinyjs.logjs(params);});
Shiny.addCustomMessageHandler('shinyjs-runjs', function(params) { shinyjs.debugMessage('shinyjs: calling function "runjs" with parameters:'); shinyjs.debugMessage(params); shinyjs.runjs(params);});
Shiny.addCustomMessageHandler('shinyjs-reset', function(params) { shinyjs.debugMessage('shinyjs: calling function "reset" with parameters:'); shinyjs.debugMessage(params); shinyjs.reset(params);});
Shiny.addCustomMessageHandler('shinyjs-delay', function(params) { shinyjs.debugMessage('shinyjs: calling function "delay" with parameters:'); shinyjs.debugMessage(params); shinyjs.delay(params);});
Shiny.addCustomMessageHandler('shinyjs-click', function(params) { shinyjs.debugMessage('shinyjs: calling function "click" with parameters:'); shinyjs.debugMessage(params); shinyjs.click(params);});
Shiny.addCustomMessageHandler('shinyjs-refresh', function(params) { shinyjs.debugMessage('shinyjs: calling function "refresh" with parameters:'); shinyjs.debugMessage(params); shinyjs.refresh(params);});</script>
<script src="shinyjs/shinyjs-default-funcs.js"></script>
<script>shinyjs.debug = false;</script>
<style>.shinyjs-hide { display: none !important; }</style>
<!--/SHINY.SINGLETON[223eed69850a44625b94f39193177e317dbc7f92]-->
</div>
</div>
<div id="welcome" class="sd-page">
<section id="welcome-to-our-survey" class="level1">
<h1>Welcome to our survey!</h1>
<p>Thank you for participating in this survey, which is part of a research effort by The George Washington University. For this survey, we will ask you about your preferences for different types of apples.</p>
<div class="cell">
<div class="cell-output-display">
<button id="next-consent" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'consent');">Next</button>
</div>
</div>
</section>
</div>
<section id="consent" class="level1 sd-page">
<h1>Consent</h1>
<p>This survey is being conducted by students at The George Washing University. We will not be collecting any identifying data, such as your name or address. The whole survey will take approximately 10 to 15 minutes to complete. Your participation is voluntary and you may stop the survey at any time.</p>
<p>If you would like to participate, please answer the following questions:</p>
<div class="cell">
<div class="cell-output-display">
<div id="container- consent_age" data-question-id="consent_age" data-required="true" class="question-container">
<div id="consent_age" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="consent_age-label">
<label class="control-label" id="consent_age-label" for="consent_age"><p>I am age 18 or older <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="consent_age" value="yes">
<span>Yes</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="consent_age" value="no">
<span>No</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="container- consent_understand" data-question-id="consent_understand" data-required="true" class="question-container">
<div id="consent_understand" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="consent_understand-label">
<label class="control-label" id="consent_understand-label" for="consent_understand"><p>I have read and understand the above information <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="consent_understand" value="yes">
<span>Yes</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="consent_understand" value="no">
<span>No</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-favorite_fruit" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'favorite_fruit');">Next</button>
</div>
</div>
</section>
<div id="favorite_fruit" class="sd-page">
<section id="favorite-fruit" class="level1">
<h1>Favorite Fruit</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- like_fruit" data-question-id="like_fruit" data-required="true" class="question-container">
<div id="like_fruit" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="like_fruit-label">
<label class="control-label" id="like_fruit-label" for="like_fruit"><p>Do you like fruit? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="like_fruit" value="yes">
<span>Yes!</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="like_fruit" value="kind_of">
<span>Kind of</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="like_fruit" value="no">
<span>No :(</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="container- fav_fruit" data-question-id="fav_fruit" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="fav_fruit-label" for="fav_fruit"><p>What is your favorite fruit? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<input id="fav_fruit" type="text" class="shiny-input-text form-control" value="">
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-screening" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'screening');">Next</button>
</div>
</div>
</section>
</div>
<div id="screening" class="sd-page">
<section id="screening-questions" class="level1">
<h1>Screening Questions</h1>
<p>For this example, I’m using the response here to screen out respondents - I’m only interested in people who choose <strong>“Red”</strong>, so if you choose “Blue” you’ll be screened out.</p>
<p>Usually you would not tell respondents ahead of time how they will be screened - I’m just putting an explanation here since this whole survey is for demonstration purposes</p>
<div class="cell">
<div class="cell-output-display">
<div id="container- screenout" data-question-id="screenout" data-required="true" class="question-container">
<div id="screenout" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="screenout-label">
<label class="control-label" id="screenout-label" for="screenout"><p>Before we go on, please select which color you prefer between these two: <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="screenout" value="blue">
<span>Blue</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="screenout" value="red">
<span>Red</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-educational" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'educational');">Next</button>
</div>
</div>
</section>
</div>
<div id="educational" class="sd-page">
<section id="educational-page" class="level1">
<h1>Educational Page</h1>
<p>Great work!</p>
<p>Now that you’ve shared a bit about yourself, we’d like you to consider a shopping scenario in which you can choose some apples to purchase from a set of apples with different attributes.</p>
<p>Let’s learn about these attributes.</p>
<section id="price" class="level2">
<h2 class="anchored" data-anchor-id="price">Price</h2>
<p>Price refers to the full price you will pay (including taxes) for the apples</p>
</section>
<section id="freshness" class="level2">
<h2 class="anchored" data-anchor-id="freshness">Freshness</h2>
<p>The freshness of the apple will be presented as one of three different categories:</p>
<ul>
<li><strong>Excellent</strong>: No bruising or marks.</li>
<li><strong>Average</strong>: One or two light bruises.</li>
<li><strong>Poor</strong>: Multiple bruises and marks.</li>
</ul>
</section>
<section id="type" class="level2">
<h2 class="anchored" data-anchor-id="type">Type</h2>
<p>We will show five different types of apples:</p>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 22%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Fuji</th>
<th>Gala</th>
<th>Honeycrisp</th>
<th>Pink Lady</th>
<th>Red Delicious</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"></td>
<td><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/gala.jpg" width="100"></td>
<td><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"></td>
<td><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/pinkLady.jpg" width="100"></td>
<td><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/redDelicious.jpg" width="100"></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_practice" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_practice');">Next</button>
</div>
</div>
</section>
</section>
</div>
<div id="cbc_practice" class="sd-page">
<section id="choice-based-conjoint-cbc-practice" class="level1">
<h1>Choice-based Conjoint (cbc) Practice</h1>
<p>We’ll now begin the choice tasks. On the next few pages we will show you three options of apples and we’ll ask you to choose the one you most prefer.</p>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_practice" data-question-id="cbc_practice" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_practice-label" for="cbc_practice"><p>For example, if these were the only apples available, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_practice" class="radio-group-buttons">
<div aria-labelledby="cbc_practice-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_practice1" name="cbc_practice" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_practice1"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: $ 2 / lb<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_practice2" name="cbc_practice" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_practice2"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/pinkLady.jpg" width="100"><br><strong>Type</strong>: Pink Lady<br><strong>Price</strong>: $ 1.5 / lb<br><strong>Freshness</strong>: Excellent</label>
<input type="radio" autocomplete="off" id="cbc_practice3" name="cbc_practice" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_practice3"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"><br><strong>Type</strong>: Honeycrisp<br><strong>Price</strong>: $ 2 / lb<br><strong>Freshness</strong>: Poor</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_intro" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_intro');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_intro" class="sd-page">
<section id="conjoint-question-intro" class="level1">
<h1>Conjoint Question Intro</h1>
<p>Great work!</p>
<p>We will now show you 6 sets of choice questions starting on the next page.</p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q1" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q1');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q1" class="sd-page">
<section id="conjoint-question-1" class="level1">
<h1>Conjoint Question 1</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q1" data-question-id="cbc_q1" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q1-label" for="cbc_q1"><p>(1 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q1" class="radio-group-buttons">
<div aria-labelledby="cbc_q1-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q11" name="cbc_q1" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q11"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/redDelicious.jpg" width="100"><br><strong>Type</strong>: Red Delicious<br><strong>Price</strong>: 1.5<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q12" name="cbc_q1" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q12"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: 3<br><strong>Freshness</strong>: Excellent</label>
<input type="radio" autocomplete="off" id="cbc_q13" name="cbc_q1" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q13"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: 2.5<br><strong>Freshness</strong>: Average</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q2" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q2');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q2" class="sd-page">
<section id="conjoint-question-2" class="level1">
<h1>Conjoint Question 2</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q2" data-question-id="cbc_q2" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q2-label" for="cbc_q2"><p>(2 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q2" class="radio-group-buttons">
<div aria-labelledby="cbc_q2-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q21" name="cbc_q2" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q21"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/pinkLady.jpg" width="100"><br><strong>Type</strong>: Pink Lady<br><strong>Price</strong>: 2<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q22" name="cbc_q2" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q22"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"><br><strong>Type</strong>: Honeycrisp<br><strong>Price</strong>: 3.5<br><strong>Freshness</strong>: Excellent</label>
<input type="radio" autocomplete="off" id="cbc_q23" name="cbc_q2" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q23"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: 1.5<br><strong>Freshness</strong>: Excellent</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q3" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q3');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q3" class="sd-page">
<section id="conjoint-question-3" class="level1">
<h1>Conjoint Question 3</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q3" data-question-id="cbc_q3" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q3-label" for="cbc_q3"><p>(3 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q3" class="radio-group-buttons">
<div aria-labelledby="cbc_q3-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q31" name="cbc_q3" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q31"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"><br><strong>Type</strong>: Honeycrisp<br><strong>Price</strong>: 2.5<br><strong>Freshness</strong>: Poor</label>
<input type="radio" autocomplete="off" id="cbc_q32" name="cbc_q3" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q32"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/redDelicious.jpg" width="100"><br><strong>Type</strong>: Red Delicious<br><strong>Price</strong>: 2<br><strong>Freshness</strong>: Excellent</label>
<input type="radio" autocomplete="off" id="cbc_q33" name="cbc_q3" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q33"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: 4<br><strong>Freshness</strong>: Average</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q4" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q4');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q4" class="sd-page">
<section id="conjoint-question-4" class="level1">
<h1>Conjoint Question 4</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q4" data-question-id="cbc_q4" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q4-label" for="cbc_q4"><p>(4 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q4" class="radio-group-buttons">
<div aria-labelledby="cbc_q4-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q41" name="cbc_q4" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q41"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/gala.jpg" width="100"><br><strong>Type</strong>: Gala<br><strong>Price</strong>: 2<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q42" name="cbc_q4" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q42"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/gala.jpg" width="100"><br><strong>Type</strong>: Gala<br><strong>Price</strong>: 1.5<br><strong>Freshness</strong>: Excellent</label>
<input type="radio" autocomplete="off" id="cbc_q43" name="cbc_q4" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q43"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/gala.jpg" width="100"><br><strong>Type</strong>: Gala<br><strong>Price</strong>: 3<br><strong>Freshness</strong>: Poor</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q5" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q5');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q5" class="sd-page">
<section id="conjoint-question-5" class="level1">
<h1>Conjoint Question 5</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q5" data-question-id="cbc_q5" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q5-label" for="cbc_q5"><p>(5 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q5" class="radio-group-buttons">
<div aria-labelledby="cbc_q5-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q51" name="cbc_q5" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q51"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"><br><strong>Type</strong>: Honeycrisp<br><strong>Price</strong>: 2.5<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q52" name="cbc_q5" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q52"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/redDelicious.jpg" width="100"><br><strong>Type</strong>: Red Delicious<br><strong>Price</strong>: 4<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q53" name="cbc_q5" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q53"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/redDelicious.jpg" width="100"><br><strong>Type</strong>: Red Delicious<br><strong>Price</strong>: 2<br><strong>Freshness</strong>: Excellent</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-cbc_q6" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'cbc_q6');">Next</button>
</div>
</div>
</section>
</div>
<div id="cbc_q6" class="sd-page">
<section id="conjoint-question-6" class="level1">
<h1>Conjoint Question 6</h1>
<div class="cell">
<div class="cell-output-display">
<div id="container- cbc_q6" data-question-id="cbc_q6" data-required="true" class="question-container">
<div class="form-group shiny-input-container shiny-input-radiogroup shiny-input-container-inline" style="width:100%;">
<label class="control-label" id="cbc_q6-label" for="cbc_q6"><p>(6 of 6) If these were your only options, which would you choose? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<br>
<div id="cbc_q6" class="radio-group-buttons">
<div aria-labelledby="cbc_q6-label" class="btn-group btn-group-container-sw" data-toggle="buttons" role="group">
<input type="radio" autocomplete="off" id="cbc_q61" name="cbc_q6" value="option_1" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q61"><strong>Option 1</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/honeycrisp.jpg" width="100"><br><strong>Type</strong>: Honeycrisp<br><strong>Price</strong>: 1.5<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q62" name="cbc_q6" value="option_2" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q62"><strong>Option 2</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/pinkLady.jpg" width="100"><br><strong>Type</strong>: Pink Lady<br><strong>Price</strong>: 3.5<br><strong>Freshness</strong>: Average</label>
<input type="radio" autocomplete="off" id="cbc_q63" name="cbc_q6" value="option_3" class="btn-check">
<label class="btn radiobtn btn-outline-primary" for="cbc_q63"><strong>Option 3</strong><br><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"><br><strong>Type</strong>: Fuji<br><strong>Price</strong>: 1.5<br><strong>Freshness</strong>: Excellent</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-apple_knowledge" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'apple_knowledge');">Next</button>
</div>
</div>
</section>
</div>
<div id="apple_knowledge" class="sd-page">
<section id="apple-knowledge" class="level2">
<h2 class="anchored" data-anchor-id="apple-knowledge">Apple Knowledge</h2>
<p>Thank you for your feedback! The next section will ask some basic questions about apples.</p>
<p>Please answer to the best of your knowledge.</p>
<div class="cell">
<div class="cell-output-display">
<div id="container- apple_knowledge_1" data-question-id="apple_knowledge_1" data-required="true" class="question-container">
<div id="apple_knowledge_1" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="apple_knowledge_1-label">
<label class="control-label" id="apple_knowledge_1-label" for="apple_knowledge_1"><p>Please select the type of this apple:</p>
<p><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/fuji.jpg" width="100"> <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_1" value="fuji">
<span>Fuji</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_1" value="gala">
<span>Gala</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_1" value="honeycrisp">
<span>Honeycrisp</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_1" value="pink_lady">
<span>Pink Lady</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_1" value="red_delicious">
<span>Red Delicious</span>
</label>
</div>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="container- apple_knowledge_2" data-question-id="apple_knowledge_2" data-required="true" class="question-container">
<div id="apple_knowledge_2" style="width:100%;" class="form-group shiny-input-radiogroup shiny-input-container" role="radiogroup" aria-labelledby="apple_knowledge_2-label">
<label class="control-label" id="apple_knowledge_2-label" for="apple_knowledge_2"><p>Please select the type of this apple:</p>
<p><img src="https://raw.githubusercontent.com/jhelvy/formr4conjoint/master/survey/images/gala.jpg" width="100"> <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div class="shiny-options-group">
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_2" value="fuji">
<span>Fuji</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_2" value="gala">
<span>Gala</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_2" value="honeycrisp">
<span>Honeycrisp</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_2" value="pink_lady">
<span>Pink Lady</span>
</label>
</div>
<div class="radio">
<label>
<input type="radio" name="apple_knowledge_2" value="red_delicious">
<span>Red Delicious</span>
</label>
</div>
</div>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-demographics" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'demographics');">Next</button>
</div>
</div>
</section>
</div>
<div id="demographics" class="sd-page">
<section id="demographics-page" class="level1">
<h1>Demographics Page</h1>
<section id="nice-job" class="level2">
<h2 class="anchored" data-anchor-id="nice-job">Nice job!</h2>
<p>We’re almost done! We’d just like to ask just a few more questions about you which we will only use for analyzing our survey data.</p>
<div class="cell">
<div class="cell-output-display no-overflow-x">
<div id="container- year_of_birth" data-question-id="year_of_birth" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="year_of_birth-label" for="year_of_birth"><p>(1) In what year were you born? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div>
<select id="year_of_birth" class="shiny-input-select"><option value="">Choose an option...</option>
<option value="prefer_not_say">Prefer not to say</option>
<option value="2003">2003</option>
<option value="2002">2002</option>
<option value="2001">2001</option>
<option value="2000">2000</option>
<option value="1999">1999</option>
<option value="1998">1998</option>
<option value="1997">1997</option>
<option value="1996">1996</option>
<option value="1995">1995</option>
<option value="1994">1994</option>
<option value="1993">1993</option>
<option value="1992">1992</option>
<option value="1991">1991</option>
<option value="1990">1990</option>
<option value="1989">1989</option>
<option value="1988">1988</option>
<option value="1987">1987</option>
<option value="1986">1986</option>
<option value="1985">1985</option>
<option value="1984">1984</option>
<option value="1983">1983</option>
<option value="1982">1982</option>
<option value="1981">1981</option>
<option value="1980">1980</option>
<option value="1979">1979</option>
<option value="1978">1978</option>
<option value="1977">1977</option>
<option value="1976">1976</option>
<option value="1975">1975</option>
<option value="1974">1974</option>
<option value="1973">1973</option>
<option value="1972">1972</option>
<option value="1971">1971</option>
<option value="1970">1970</option>
<option value="1969">1969</option>
<option value="1968">1968</option>
<option value="1967">1967</option>
<option value="1966">1966</option>
<option value="1965">1965</option>
<option value="1964">1964</option>
<option value="1963">1963</option>
<option value="1962">1962</option>
<option value="1961">1961</option>
<option value="1960">1960</option>
<option value="1959">1959</option>
<option value="1958">1958</option>
<option value="1957">1957</option>
<option value="1956">1956</option>
<option value="1955">1955</option>
<option value="1954">1954</option>
<option value="1953">1953</option>
<option value="1952">1952</option>
<option value="1951">1951</option>
<option value="1950">1950</option>
<option value="1949">1949</option>
<option value="1948">1948</option>
<option value="1947">1947</option>
<option value="1946">1946</option>
<option value="1945">1945</option>
<option value="1944">1944</option>
<option value="1943">1943</option>
<option value="1942">1942</option>
<option value="1941">1941</option>
<option value="1940">1940</option>
<option value="1939">1939</option>
<option value="1938">1938</option>
<option value="1937">1937</option>
<option value="1936">1936</option>
<option value="1935">1935</option>
<option value="1934">1934</option>
<option value="1933">1933</option>
<option value="1932">1932</option>
<option value="1931">1931</option>
<option value="1930">1930</option>
<option value="1929">1929</option>
<option value="1928">1928</option>
<option value="1927">1927</option>
<option value="1926">1926</option>
<option value="1925">1925</option>
<option value="1924">1924</option>
<option value="1923">1923</option>
<option value="1922">1922</option>
<option value="1921">1921</option>
<option value="1920">1920</option></select>
<script type="application/json" data-for="year_of_birth">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div id="container- gender" data-question-id="gender" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="gender-label" for="gender"><p>(2) What is your current gender identity? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div>
<select id="gender" class="shiny-input-select"><option value="">Choose an option...</option>
<option value="male">Male</option>
<option value="female">Female</option>
<option value="non_binary">Non-binary</option>
<option value="trans_male">Trans male/trans man</option>
<option value="trans_female">Trans female/trans woman</option>
<option value="prefer_not_to_say">Prefer not to say</option></select>
<script type="application/json" data-for="gender">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div id="container- race" data-question-id="race" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="race-label" for="race"><p>(3) I identify my race as (select all that apply): <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div>
<select id="race" class="shiny-input-select"><option value="">Choose an option...</option>
<option value="white">White (Not of Hispanic or Latino origin)</option>
<option value="black">African American or Black</option>
<option value="asian">Asian</option>
<option value="hispanic">Hispanic or Latino </option>
<option value="native_american">American Indian or Alaska Native</option>
<option value="pacific_islander">Native Hawaiian or Other Pacific Islander</option>
<option value="prefer_not_to_say">Prefer not to say</option></select>
<script type="application/json" data-for="race">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div id="container- education" data-question-id="education" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="education-label" for="education"><p>(4) What is the highest degree or level of school you have completed? If currently enrolled, please use the highest degree received. <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div>
<select id="education" class="shiny-input-select"><option value="">Choose an option...</option>
<option value="less_than_high_school">Less than high school</option>
<option value="high_school">High school</option>
<option value="some_college">Some college</option>
<option value="associate_degree">Associate's degree</option>
<option value="bachelor_degree">Bachelor's degree</option>
<option value="master_degree">Master's degree</option>
<option value="doctoral_degree">Doctoral degree</option>
<option value="prefer_not_to_say">Prefer not to say</option></select>
<script type="application/json" data-for="education">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="cell-output-display no-overflow-x">
<div id="container- income" data-question-id="income" data-required="true" class="question-container">
<div class="form-group shiny-input-container" style="width:100%;">
<label class="control-label" id="income-label" for="income"><p>(5) What is your annual household income (from all sources) before taxes and other deductions from pay? <span style="color: red; font-size: 1.5em; vertical-align: middle; position: relative; top: 0.1em;">*</span></p>
</label>
<div>
<select id="income" class="shiny-input-select"><option value="">Choose an option...</option>
<option value="less_than_10k">Less than $10,000</option>
<option value="10k_to_14k">$10,000 to $14,999</option>
<option value="15k_to_19k">$15,000 to $19,999</option>
<option value="20k_to_24k">$20,000 to $24,999</option>
<option value="25k_to_29k">$25,000 to $29,999</option>
<option value="30k_to_34k">$30,000 to $34,999</option>
<option value="35k_to_39k">$35,000 to $39,999</option>
<option value="40k_to_49k">$40,000 to $49,999</option>
<option value="50k_to_74k">$50,000 to $74,999</option>
<option value="75k_to_99k">$75,000 to $99,999</option>
<option value="100k_to_149k">$100,000 to $149,999</option>
<option value="150k_to_199k">$150,000 to $199,999</option>
<option value="200k_or_more">$200,000 or more</option>
<option value="prefer_not_to_say">Prefer not to say</option></select>
<script type="application/json" data-for="income">{"plugins":["selectize-plugin-a11y"]}</script>
</div>
</div>
</div>
</div>
<div class="cell-output-display">
<div id="container- feedback" data-question-id="feedback" data-required="false" class="question-container">
<div class="form-group shiny-input-container" style="width: 100%;">
<label class="control-label" id="feedback-label" for="feedback"><p>Please let us know if you have any other thoughts or feedback on this survey.</p>
<p>Your feedback will help us make future improvements :)</p>
</label>
<textarea id="feedback" class="shiny-input-textarea form-control" style="width:100%;height:100px;" rows="6" cols="80"></textarea>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<button id="next-end_normal" type="button" class="btn btn-default action-button" style="display: block; margin: auto;" onclick="Shiny.setInputValue('next_page', 'end_normal');">Next</button>
</div>
</div>
</section>
</section>
</div>
<div id="end_normal" class="sd-page">
<section id="end-page" class="level1">
<h1>End Page</h1>
<p>The survey is finished. Thank you for your feedback!</p>
<p>Your completion code is: <strong>418320</strong>.</p>
<p>You may close the window now.</p>
</section>
</div>
<div id="end_consent" class="sd-page">
<section id="end-page-1" class="level1">
<h1>End Page</h1>
<p>The survey is now finished. You may close the window.</p>
</section>
</div>
<div id="end_screenout" class="sd-page">
<section id="end-page-2" class="level1">
<h1>End Page</h1>
<p>Sorry, we wanted you to select the <strong>red</strong> button.</p>
<p>The survey is now finished. You may close the window.</p>
</section>
</div>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
# Run this in your Terminal to install the Quarto extension:
# quarto install extension jhelvy/surveydown-ext

# Run this in your Console to install the R package:
# remotes::install_github("jhelvy/surveydown", force = TRUE)

# Load the package locally:
# devtools::load_all("../surveydown")

# Load the package from library:
library(surveydown)

# Load other necessary packages:
library(tidyverse)
library(glue)

# This is essential to the survey:
sd_setup()
</script>
 
<script type="application/shiny-prerendered" data-context="server">
#This is what the user has to input
# db <- sd_database(
#   host = "aws-0-us-west-1.pooler.supabase.com",
#   db_name = "postgres",
#   port = "6543",
#   user = "postgres.kjxxpyqplqvtqqxrxmzi",
#   table_name = "Testing1",
#   password   = Sys.getenv("SUPABASE_PASSWORD")
# )

config <- sd_config(
  skip_if = tibble::tribble(
    ~question_id,         ~question_value, ~target,
    "screenout",          "blue",          "end_screenout",
    "consent_age",        "no",            "end_consent",
    "consent_understand", "no",            "end_consent"
  ),
  show_if = tibble::tribble(
    ~question_id,         ~question_value, ~target,
    "like_fruit",         "yes",           "fav_fruit",
    "like_fruit",         "kind_of",       "fav_fruit"
  ),
  preview = TRUE,
  show_all_pages = FALSE
)

sd_server(
  input   = input,
  session = session,
  config  = config
  # db      = db
)
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["sw-buttons-group"]},{"type":"character","attributes":{},"value":["0.8.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["packer"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["buttons-group.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shinyWidgets"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.8.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["selectize"]},{"type":"character","attributes":{},"value":["0.15.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/selectize"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/selectize.min.js","accessibility/js/selectize-plugin-a11y.min.js"]},{"type":"character","attributes":{},"value":["css/selectize.bootstrap3.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.9.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76]}},"value":[{"type":"character","attributes":{},"value":["base","bit","bit64","bslib","cachem","cli","colorspace","commonmark","compiler","crayon","curl","datasets","digest","dplyr","evaluate","fansi","fastmap","forcats","generics","ggplot2","glue","graphics","grDevices","grid","gtable","hms","htmltools","htmlwidgets","httpuv","jquerylib","jsonlite","knitr","later","lifecycle","lubridate","magrittr","markdown","memoise","methods","mime","munsell","parallel","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","rlang","rmarkdown","rstudioapi","sass","scales","shiny","shinyjs","shinyWidgets","stats","stringi","stringr","surveydown","tibble","tidyr","tidyselect","tidyverse","timechange","tools","tzdb","utf8","utils","vctrs","vroom","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["4.3.0","4.0.5","4.0.5","0.8.0","1.1.0","3.6.3","2.1-0","1.9.1","4.3.0","1.5.3","5.2.1","4.3.0","0.6.36","1.1.4","0.24.0","1.0.6","1.2.0","1.0.0","0.1.3","3.5.0","1.7.0","4.3.0","4.3.0","4.3.0","0.3.4","1.1.3","0.5.8.1","1.6.4","1.6.15","0.1.4","1.8.8","1.48","1.3.2","1.0.4","1.9.3","2.0.3","1.13","2.0.1","4.3.0","0.12","0.5.0","4.3.0","1.9.0","2.0.3","1.3.0","1.0.2","2.5.1","1.0.13","2.1.5","1.1.4","2.27","0.16.0","0.4.9.9000","1.3.0","1.9.1","2.1.0","0.8.6","4.3.0","1.8.4","1.5.1","0.0.5","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","4.3.0","0.4.0","1.2.4","4.3.0","0.6.5","1.6.5","3.0.1","0.46","1.8-4","2.3.10"]}]}]}
</script>
<!--/html_preserve-->

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>